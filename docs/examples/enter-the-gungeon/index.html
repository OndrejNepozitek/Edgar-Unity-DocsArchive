<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/Edgar-Unity-DocsArchive/blog/rss.xml" title="Edgar - Unity: Alpha docs archive Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Edgar-Unity-DocsArchive/blog/atom.xml" title="Edgar - Unity: Alpha docs archive Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-31904365-17","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">(PRO) Enter the Gungeon | Edgar - Unity: Alpha docs archive</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.0.0-alpha.9"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.0.0-alpha.9"><meta data-react-helmet="true" property="og:title" content="(PRO) Enter the Gungeon | Edgar - Unity: Alpha docs archive"><meta data-react-helmet="true" name="description" content="In this tutorial, we will look into how to generate levels similar to what we can see in Enter the Gungeon. We will use this tileset by @pixelpoem - be sure to check out their work if you like the tileset."><meta data-react-helmet="true" property="og:description" content="In this tutorial, we will look into how to generate levels similar to what we can see in Enter the Gungeon. We will use this tileset by @pixelpoem - be sure to check out their work if you like the tileset."><meta data-react-helmet="true" property="og:url" content="https://ondrejnepozitek.github.io/Edgar-Unity-DocsArchive/docs/examples/enter-the-gungeon"><link data-react-helmet="true" rel="shortcut icon" href="/Edgar-Unity-DocsArchive/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ondrejnepozitek.github.io/Edgar-Unity-DocsArchive/docs/examples/enter-the-gungeon"><link rel="stylesheet" href="/Edgar-Unity-DocsArchive/styles.59163da7.css">
<link rel="preload" href="/Edgar-Unity-DocsArchive/styles.1de33962.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/runtime~main.ed91e56c.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/main.b98b1f40.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/1.2b6eab23.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/1be78505.36a57963.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/300.10d19e34.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/301.5c69e847.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/0e62f188.31cbd126.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/299.f7900408.js" as="script">
<link rel="preload" href="/Edgar-Unity-DocsArchive/cbd1a036.12b7f0af.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/Edgar-Unity-DocsArchive/"><strong class="navbar__title">Edgar - Unity: Alpha docs archive</strong></a><a href="https://ondrejnepozitek.github.io/Edgar-Unity/docs/introduction/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Link to live docs (this is only archive)</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Edgar-Unity-DocsArchive/docs/introduction">Archive docs</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/Edgar-Unity-DocsArchive/docs/introduction">Archive: 2.0.0-alpha.9</a></li><li><a class="dropdown__link" href="/Edgar-Unity-DocsArchive/docs/2.0.0-alpha.8/introduction">Archive: 2.0.0-alpha.8</a></li><li><a class="dropdown__link" href="/Edgar-Unity-DocsArchive/docs/2.0.0-alpha.7/introduction">Archive: 2.0.0-alpha.7</a></li></ul></div><a href="https://github.com/OndrejNepozitek/Edgar-Unity/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Edgar-Unity-DocsArchive/"><strong class="navbar__title">Edgar - Unity: Alpha docs archive</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://ondrejnepozitek.github.io/Edgar-Unity/docs/introduction/" target="_blank" rel="noopener noreferrer" class="menu__link">Link to live docs (this is only archive)</a></li><li class="menu__list-item menu__list-item--collapsed"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" role="button" href="/Edgar-Unity-DocsArchive/docs/introduction">Archive docs</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/Edgar-Unity-DocsArchive/docs/introduction">Archive: 2.0.0-alpha.9</a></li><li class="menu__list-item"><a class="menu__link" href="/Edgar-Unity-DocsArchive/docs/2.0.0-alpha.8/introduction">Archive: 2.0.0-alpha.8</a></li><li class="menu__list-item"><a class="menu__link" href="/Edgar-Unity-DocsArchive/docs/2.0.0-alpha.7/introduction">Archive: 2.0.0-alpha.7</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/OndrejNepozitek/Edgar-Unity/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/motivation">Motivation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/installation">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/basics/introduction">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/basics/room-templates">Room templates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/basics/level-graphs">Level graphs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/basics/generator-setup">Generator setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/basics/generated-level-info">Level structure and rooms data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/basics/performance-tips">Performance tips</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Generators</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/generators/dungeon-generator">Dungeon generator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/generators/post-process">Post-processing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/generators/platformer-generator">(PRO) Platformer generator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/generators/custom-input">(PRO) Custom input</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/examples/example-1">Example 1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/examples/example-2">Example 2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/examples/platformer-1">(PRO) Platformer 1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/examples/isometric-1">(PRO) Isometric 1</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/examples/enter-the-gungeon">(PRO) Enter the Gungeon</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/examples/dead-cells">(PRO) Dead Cells</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/guides/room-template-customization">Room template customization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/guides/current-room-detection">Current room detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/guides/fog-of-war">(PRO) Fog of war</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/guides/minimap">(PRO) Minimap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/guides/door-sockets">(PRO) Door sockets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/guides/directed-level-graphs">(PRO) Directed level graphs</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Other</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Edgar-Unity-DocsArchive/docs/other/migration-v1-v2">Migration from v1 to v2</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><div><span class="badge badge--secondary">Version: 2.0.0-alpha.9</span></div><header><h1 class="docTitle_Oumm">(PRO) Enter the Gungeon</h1></header><div class="markdown"><p>In this tutorial, we will look into how to generate levels similar to what we can see in <a href="https://store.steampowered.com/app/311690/Enter_the_Gungeon/" target="_blank" rel="noopener noreferrer">Enter the Gungeon</a>. We will use <a href="https://pixel-poem.itch.io/dungeon-assetpuck" target="_blank" rel="noopener noreferrer">this tileset</a> by <a href="https://twitter.com/pixel_poem" target="_blank" rel="noopener noreferrer">@pixel_poem</a> - be sure to check out their work if you like the tileset.</p><blockquote><p><strong>Disclaimer:</strong> We are in no way affiliated with the authors of the Enter the Gungeon game and this plugin is not used in the game. This is only a case study about how to use this plugin to create something similar to what is done in that game.</p></blockquote><div style="font-size:0px;margin:20px 0"><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result1.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result1.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Example result</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result2.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result2.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Example result</div></div></div><video width="100%" muted="" style="margin-bottom:15px;margin-top:-15px"><source src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/example_video.mp4" type="video/mp4">Your browser does not support the video tag.</video><blockquote><p><strong>Note:</strong> All files from this example can be found at <em>Edgar/Examples/EnterTheGungeon</em>.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="room-templates"></a>Room templates<a class="hash-link" href="#room-templates" title="Direct link to heading">#</a></h2><blockquote><p><strong>Note:</strong> If you want to add some more room templates, be sure to use the <em>Create</em> menu (<em>Examples/Enter the Gungeon/Room template</em>) or duplicate one of the existing room templates.</p></blockquote><div style="font-size:0px;margin:20px 0"><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/entrance.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/entrance.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Entrance</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/hub1.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/hub1.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Hub</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/normal5.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/normal5.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Normal</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/reward.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/reward.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Reward</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/shop.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/shop.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Shop</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/secret.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/secret.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Secret</div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="level-graphs"></a>Level graphs<a class="hash-link" href="#level-graphs" title="Direct link to heading">#</a></h2><p>In Enter the Gungeon, they use multiple level graphs for each stage of the game.</p><div style="font-size:0px;margin:20px 0"><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/level_graph_2.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/level_graph_2.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Stage 1 level graph</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/level_graph_1.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/level_graph_1.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Stage 2 level graph</div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="custom-rooms-and-connections"></a>Custom rooms and connections<a class="hash-link" href="#custom-rooms-and-connections" title="Direct link to heading">#</a></h3><p>In the level graph above, we used custom room and connection types. We use this feature to add additional data to rooms and connection and also to change how they are displayed in the editor.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rooms"></a>Rooms<a class="hash-link" href="#rooms" title="Direct link to heading">#</a></h4><p>Each room in Enter the Gungeon has its type - there are rooms with enemies, treasure rooms, shops, etc. We use a custom room implementation to add the <code>GungGungeonRoomType Type</code> field to each room. Moreover, we use different colours to distinguish different types of rooms in the level graph editor.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="connections"></a>Connections<a class="hash-link" href="#connections" title="Direct link to heading">#</a></h4><p>Some corridors in Enter the Gungeon are locked and can be unlocked only from the other side of the door. This is usually used to force the player to go trough a loop that ends with a treasure or shop room and the door then serves as a shortcut to get back to the main path. We use a custom connection implementation to add the <code>bool IsLocked</code> field. If the door is locked, we use red colour to draw the line between the two rooms.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1shy tabs__item--active">GungeonRoom.cs</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1shy">GungeonConnection.cs</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">class</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonRoom</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">RoomBase</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonRoomType</span><span class="token plain"> Type</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> List</span><span class="token operator" style="color:rgb(204, 130, 66)">&lt;</span><span class="token plain">GameObject</span><span class="token operator" style="color:rgb(204, 130, 66)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GetRoomTemplates</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// We do not need any room templates here because they are resolved based on the type of the room.</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">null</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">string</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GetDisplayName</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Use the type of the room as its display name.</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">return</span><span class="token plain"> Type</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">ToString</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">RoomEditorStyle</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GetEditorStyle</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token keyword" style="color:rgb(204, 130, 66)">bool</span><span class="token plain"> isFocused</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> style </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">base</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetEditorStyle</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">isFocused</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> backgroundColor </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">BackgroundColor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Use different colors for different types of rooms</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">Type</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">case</span><span class="token plain"> GungeonRoomType</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Entrance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    backgroundColor </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">new</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">Color</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token number" style="color:rgb(122, 158, 194)">38</span><span class="token operator" style="color:rgb(204, 130, 66)">/</span><span class="token number" style="color:rgb(122, 158, 194)">256f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">115</span><span class="token operator" style="color:rgb(204, 130, 66)">/</span><span class="token number" style="color:rgb(122, 158, 194)">256f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">38</span><span class="token operator" style="color:rgb(204, 130, 66)">/</span><span class="token number" style="color:rgb(122, 158, 194)">256f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(204, 130, 66)">break</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">BackgroundColor </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> backgroundColor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Darken the color when focused</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">isFocused</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">BackgroundColor </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Color</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Lerp</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">BackgroundColor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> Color</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">black</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">0.7f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">return</span><span class="token plain"> style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">class</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonConnection</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">Connection</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">// Whether the corresponding corridor should be locked</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">bool</span><span class="token plain"> IsLocked</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">ConnectionEditorStyle</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GetEditorStyle</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token keyword" style="color:rgb(204, 130, 66)">bool</span><span class="token plain"> isFocused</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> style </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">base</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetEditorStyle</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">isFocused</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Use red color when locked</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">IsLocked</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">LineColor </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Color</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">red</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">return</span><span class="token plain"> style</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="input-setup-task"></a>Input setup task<a class="hash-link" href="#input-setup-task" title="Direct link to heading">#</a></h3><p>We will use a <a href="/Edgar-Unity-DocsArchive/docs/generators/custom-input">custom input setup task</a> because it gives us more control when working with the input. We will use it to choose a random level graph and add a random secret room. The base of the task is the same as in the <a href="/Edgar-Unity-DocsArchive/docs/examples/dead-cells#input-setup">Dead Cells</a> example.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pick-random-level-graph"></a>Pick random level graph<a class="hash-link" href="#pick-random-level-graph" title="Direct link to heading">#</a></h3><p>Because we have multiple level graphs for each stage of the game, we want to choose the level graph randomly from the available options. The implementation is straightforward:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">class</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonInputSetupTask</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">DungeonGeneratorInputBase</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain"></span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token class-name" style="color:#dd4a68">Range</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token number" style="color:rgb(122, 158, 194)">1</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">2</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">int</span><span class="token plain"> Stage </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">1</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> LevelGraph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"> Stage1LevelGraphs</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> LevelGraph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"> Stage2LevelGraphs</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token keyword" style="color:rgb(204, 130, 66)">protected</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">LevelDescription</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GetLevelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">// Pick random level graph</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> levelGraphs </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Stage </span><span class="token operator" style="color:rgb(204, 130, 66)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">?</span><span class="token plain"> Stage1LevelGraphs </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> Stage2LevelGraphs</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> levelGraph </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> levelGraphs</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetRandom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">Payload</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Random</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        GungeonGameManager</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Instance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">CurrentLevelGraph </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> levelGraph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain"></span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Then we just assign level graphs to the two arrays. The last step is to control the current stage of the game. We can do that in the game manager before we generate a level:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">private</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">IEnumerator</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GeneratorCoroutine</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token class-name" style="color:#dd4a68">DungeonGenerator</span><span class="token plain"> generator</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain"></span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token comment" style="color:rgb(112, 112, 112)">// Configure the generator with the current stage number</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> inputTask </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">GungeonInputSetupTask</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> generator</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">CustomInputTask</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    inputTask</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Stage </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Stage</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain"></span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="random-secret-rooms"></a>Random secret rooms<a class="hash-link" href="#random-secret-rooms" title="Direct link to heading">#</a></h3><p>Even though all the levels are primarily guided by hand-made level graphs, there is a little bit of randomness included. When we setup the input for the algorithm, we roll a dice to determine if we want to add a secret room to the level. We can add a <code>float SecretRoomChance</code> field to the input setup and configure this value directly in the generator inspector. In Enter the Gungeon, they also choose whether to connect the room to a dead-end room or to any rooms - this is controlled with <code>SecretRoomDeadEndChance</code>.</p><p>To add the secret room to the level, we first get all the rooms from the level description and randomly choose one of them to attach the secret room to. Then we have to do 3 things. First, we create an instance of the secret room - this corresponds to a room node in the level graph. Second, we create an instance of the connection between the two rooms - this corresponds to an edge in the level graph. And third, because we use corridors, we also need to create an instance of the corridor room that is between the two rooms.</p><blockquote><p><strong>Note:</strong> Our secret rooms are not really secret as we do not hide them in any way. I may revisit this in the future to make them really secret.</p></blockquote><details><summary>Show code block</summary><div><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">class</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonInputSetupTask</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">DungeonGeneratorInputBase</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">LevelGraph</span><span class="token plain"> LevelGraph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonRoomTemplatesConfig</span><span class="token plain"> RoomTemplates</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">// The probability that a secret room is added to the level</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token class-name" style="color:#dd4a68">Range</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token number" style="color:rgb(122, 158, 194)">0f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">1f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">float</span><span class="token plain"> SecretRoomChance </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">0.9f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">// The probability that a secret room is attached to a dead-end room</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token class-name" style="color:#dd4a68">Range</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token number" style="color:rgb(122, 158, 194)">0f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">1f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">float</span><span class="token plain"> SecretRoomDeadEndChance </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">0.5f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">protected</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">LevelDescription</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">GetLevelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Add secret rooms</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token function" style="color:#ffc66d">AddSecretRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">levelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">void</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">AddSecretRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token class-name" style="color:#dd4a68">LevelDescription</span><span class="token plain"> levelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Return early if no secret room should be added to the level</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">Payload</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Random</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">NextDouble</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(204, 130, 66)">&gt;</span><span class="token plain"> SecretRoomChance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">return</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Get the graphs of rooms</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> graph </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> levelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetGraph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Decide whether to attach the secret room to a dead end room or not</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> attachToDeadEnd </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Payload</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Random</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">NextDouble</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(204, 130, 66)">&lt;</span><span class="token plain"> SecretRoomDeadEndChance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Find all the possible rooms to attach to and choose a random one</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> possibleRoomsToAttachTo </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> graph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Vertices</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">Cast</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonRoom</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Where</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(204, 130, 66)">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token operator" style="color:rgb(204, 130, 66)">!</span><span class="token plain">attachToDeadEnd </span><span class="token operator" style="color:rgb(204, 130, 66)">||</span><span class="token plain"> graph</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetNeighbours</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Count</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(204, 130, 66)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">1</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(204, 130, 66)">&amp;&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(204, 130, 66)">!=</span><span class="token plain"> GungeonRoomType</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Entrance</span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">ToList</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> roomToAttachTo </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> possibleRoomsToAttachTo</span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token class-name" style="color:#dd4a68">Payload</span><span class="token class-name punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token class-name" style="color:#dd4a68">Random</span><span class="token class-name punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token class-name" style="color:#dd4a68">Next</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">possibleRoomsToAttachTo</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Create secret room</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> secretRoom </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> ScriptableObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">CreateInstance</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonRoom</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            secretRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> GungeonRoomType</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Secret</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            levelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">AddRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">secretRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> RoomTemplates</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetRoomTemplates</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">secretRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">ToList</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Prepare the connection between secretRoom and roomToAttachTo</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> connection </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> ScriptableObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">CreateInstance</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonConnection</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            connection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">From </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> roomToAttachTo</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            connection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">To </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> secretRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Connect the two rooms with a corridor</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> corridorRoom </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> ScriptableObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">CreateInstance</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonRoom</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            corridorRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> GungeonRoomType</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Corridor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            levelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">AddCorridorConnection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">connection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> RoomTemplates</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">CorridorRoomTemplates</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">ToList</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> corridorRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div></div></details><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="room-manager"></a>Room manager<a class="hash-link" href="#room-manager" title="Direct link to heading">#</a></h2><p>In Enter the Gungeon, when a player visits a (combat-oriented) room for the first time, two things happen. First, all the doors to neighbouring rooms get closed and locked. And second, enemies are spawned. Only after all the enemies are defeated, the doors unlock.</p><video width="100%" muted=""><source src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/enter_room.mp4" type="video/mp4">Your browser does not support the video tag.</video><br><blockquote><p><strong>Note:</strong> The enemies in this example are very dumb - they just stand there and cannot be killed as there is no combat system implemented. Therefore, the doors open after some time even though enemies are still alive.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="current-room-detection"></a>Current room detection<a class="hash-link" href="#current-room-detection" title="Direct link to heading">#</a></h3><p>The base of this setup is detecting when a player enters a room. We will use the same setup as we described in the <a href="/Edgar-Unity-DocsArchive/docs/guides/current-room-detection">Current room detection</a> tutorial. That means that we have a floor collider that is set to trigger and it informs <code>RoomManager</code> when the player enters a room.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="enemies"></a>Enemies<a class="hash-link" href="#enemies" title="Direct link to heading">#</a></h3><p>We will use a very simple approach to a randomized spawn of enemies. We will use the floor collider that we set up in the previous step to get a random position inside the room.</p><p>The algorithm works as follows:</p><ol><li>Get a random position inside floor collider bounds</li><li>Check if the position is actually inside the collider (there may be holes)</li><li>Check that there are no other colliders near the position</li><li>Pick a random enemy and instantiate it at the position</li></ol><details><summary>Show code block</summary><div><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">class</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonRoomManager</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">MonoBehaviour</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/// &lt;summary&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/// Enemies that can spawn inside the room.</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/// &lt;/summary&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> GameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"> Enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/// &lt;summary&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/// Collider of the floor tilemap layer.</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/// &lt;/summary&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">Collider2D</span><span class="token plain"> FloorCollider</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">void</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">SpawnEnemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            EnemiesSpawned </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">true</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> enemies </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">new</span><span class="token plain"> </span><span class="token generic-method function" style="color:#ffc66d">List</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GameObject</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> totalEnemiesCount </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> GungeonGameManager</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Instance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Random</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Next</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token number" style="color:rgb(122, 158, 194)">4</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">8</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">while</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Count </span><span class="token operator" style="color:rgb(204, 130, 66)">&lt;</span><span class="token plain"> totalEnemiesCount</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Find random position inside floor collider bounds</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> position </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">RandomPointInBounds</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">FloorCollider</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">bounds</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">1f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Check if the point is actually inside the collider as there may be holes in the floor, etc.</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token operator" style="color:rgb(204, 130, 66)">!</span><span class="token function" style="color:#ffc66d">IsPointWithinCollider</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">FloorCollider</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(204, 130, 66)">continue</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// We want to make sure that there is no other collider in the radius of 1</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">Physics2D</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">OverlapCircleAll</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(122, 158, 194)">0.5f</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Any</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(204, 130, 66)">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(204, 130, 66)">!</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">isTrigger</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(204, 130, 66)">continue</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Pick random enemy prefab</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> enemyPrefab </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token class-name" style="color:#dd4a68">Random</span><span class="token class-name punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token class-name" style="color:#dd4a68">Range</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token number" style="color:rgb(122, 158, 194)">0</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> Enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Create an instance of the enemy and set position and parent</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> enemy </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">Instantiate</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">enemyPrefab</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                enemy</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">position </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                enemy</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">parent </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> roomInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">RoomTemplateInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Add</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">enemy</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div></div></details><br><blockquote><p><strong>Note:</strong> As the process of choosing enemy spawn points is random, we hope that the success rate is quite high and we do not have to spend too much time on it. However, if we wanted to spawn too many enemies or there were too many holes in the collider, we could have problems with performance. In that case, it would be better to use a different approach.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="doors"></a>Doors<a class="hash-link" href="#doors" title="Direct link to heading">#</a></h3><p>Our goal is to close neighbouring corridors with doors when the player enters the room and then open the doors when all the enemies are dead. The only slightly complex part is how to obtain the game objects that represent the doors. To make our lives easier, we added the doors directly to each corridor room template. That means that after the level is generated we just have to retrieve the doors from corridor room templates.</p><div style="font-size:0px;margin:20px 0"><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/ver5.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/ver5.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Vertical corridor</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/hor5.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/room_templates/hor5.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Horizontal corridor</div></div></div><p>We can do it like this:</p><ol><li>Prepare a custom post-processing task</li><li>Go trough all non-corridor rooms</li><li>Find all the corridors that are connected to the room</li><li>Get the door game object from each neighbouring corridor</li><li>Store all the doors in the room manager</li></ol><p>When we have the game objects, we can simply activate them when the player enters the room and then deactivate them when enemies are dead. (Or just open the doors after 3 seconds because we do not have any combat implemented.)</p><details><summary>Show code block</summary><div><div class="mdxCodeBlock_1zKU"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-csharp codeBlock_1wn8" style="color:#cccccc;background-color:#242424"><div class="token-line" style="color:#cccccc"><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">class</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">GungeonPostProcessTask</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">:</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">DungeonGeneratorPostProcessBase</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> GameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">[</span><span class="token punctuation" style="color:rgb(204, 130, 66)">]</span><span class="token plain"> Enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token keyword" style="color:rgb(204, 130, 66)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">override</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">void</span><span class="token plain"> </span><span class="token function" style="color:#ffc66d">Run</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token class-name" style="color:#dd4a68">GeneratedLevel</span><span class="token plain"> level</span><span class="token punctuation" style="color:rgb(204, 130, 66)">,</span><span class="token plain"> </span><span class="token class-name" style="color:#dd4a68">LevelDescription</span><span class="token plain"> levelDescription</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token comment" style="color:rgb(112, 112, 112)">/* ... */</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token keyword" style="color:rgb(204, 130, 66)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> roomInstance </span><span class="token keyword" style="color:rgb(204, 130, 66)">in</span><span class="token plain"> level</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetRoomInstances</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> room </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">GungeonRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> roomInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Room</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> roomTemplateInstance </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> roomInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">RoomTemplateInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Find floor tilemap layer</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> tilemaps </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> RoomTemplateUtils</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">GetTilemaps</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">roomTemplateInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> floor </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> tilemaps</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Single</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(204, 130, 66)">=&gt;</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">name </span><span class="token operator" style="color:rgb(204, 130, 66)">==</span><span class="token plain"> </span><span class="token string" style="color:#6a8759">&quot;Floor&quot;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Add current room detection handler</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                floor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">AddComponent</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonCurrentRoomHandler</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token comment" style="color:rgb(112, 112, 112)">// Add room manager</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> roomManager </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> roomTemplateInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">AddComponent</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonRoomManager</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">room</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(204, 130, 66)">!=</span><span class="token plain"> GungeonRoomType</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Corridor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token comment" style="color:rgb(112, 112, 112)">// Set enemies and floor collider to the room manager</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    roomManager</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Enemies </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> Enemies</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    roomManager</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">FloorCollider </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> floor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">GetComponent</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">CompositeCollider2D</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token comment" style="color:rgb(112, 112, 112)">// Find all the doors of neighboring corridors and save them in the room manager</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token comment" style="color:rgb(112, 112, 112)">// The term &quot;door&quot; has two different meanings here:</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token comment" style="color:rgb(112, 112, 112)">//   1. it represents the connection point between two rooms in the level</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token comment" style="color:rgb(112, 112, 112)">//   2. it represents the door game object that we have inside each corridor</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(204, 130, 66)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> door </span><span class="token keyword" style="color:rgb(204, 130, 66)">in</span><span class="token plain"> roomInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Doors</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token comment" style="color:rgb(112, 112, 112)">// Get the room instance of the room that is connected via this door</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> corridorRoom </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> door</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">ConnectedRoomInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token comment" style="color:rgb(112, 112, 112)">// Get the room template instance of the corridor room</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> corridorGameObject </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> corridorRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">RoomTemplateInstance</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token comment" style="color:rgb(112, 112, 112)">// Find the door game object by its name</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> doorsGameObject </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> corridorGameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Find</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token string" style="color:#6a8759">&quot;Door&quot;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">?.</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token comment" style="color:rgb(112, 112, 112)">// Each corridor room instance has a connection that represents the edge in the level graph</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token comment" style="color:rgb(112, 112, 112)">// We use the connection object to check if the corridor should be locked or not</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token keyword" style="color:rgb(204, 130, 66)">var</span><span class="token plain"> connection </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">GungeonConnection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"> corridorRoom</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Connection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">doorsGameObject </span><span class="token operator" style="color:rgb(204, 130, 66)">!=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(204, 130, 66)">null</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token comment" style="color:rgb(112, 112, 112)">// If the connection is locked, we set the Locked state and keep the game object active</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token comment" style="color:rgb(112, 112, 112)">// Otherwise we set the EnemyLocked state and deactivate the door. That means that the door is active and locked</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token comment" style="color:rgb(112, 112, 112)">// only when there are enemies in the room.</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token keyword" style="color:rgb(204, 130, 66)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">connection</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">IsLocked</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                                doorsGameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">GetComponent</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonDoor</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">State </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> GungeonDoor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">DoorState</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Locked</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token keyword" style="color:rgb(204, 130, 66)">else</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                                doorsGameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token generic-method function" style="color:#ffc66d">GetComponent</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&lt;</span><span class="token generic-method class-name" style="color:#dd4a68">GungeonDoor</span><span class="token generic-method punctuation" style="color:rgb(204, 130, 66)">&gt;</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">State </span><span class="token operator" style="color:rgb(204, 130, 66)">=</span><span class="token plain"> GungeonDoor</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">DoorState</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">EnemyLocked</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                                doorsGameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">SetActive</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token keyword" style="color:rgb(204, 130, 66)">false</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            </span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                            roomManager</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token plain">Doors</span><span class="token punctuation" style="color:rgb(204, 130, 66)">.</span><span class="token function" style="color:#ffc66d">Add</span><span class="token punctuation" style="color:rgb(204, 130, 66)">(</span><span class="token plain">doorsGameObject</span><span class="token punctuation" style="color:rgb(204, 130, 66)">)</span><span class="token punctuation" style="color:rgb(204, 130, 66)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#cccccc"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(204, 130, 66)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div></div></details><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="locked-doors"></a>Locked doors<a class="hash-link" href="#locked-doors" title="Direct link to heading">#</a></h3><p>The last thing that we have to handle are doors that should be locked even if there are no enemies. These doors are used to separate reward/shop rooms from other rooms and force the player to find a different path to the reward room. When the player discovers the reward room, all the neighbouring locked doors are unlocked.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="fog-of-war"></a>Fog of War<a class="hash-link" href="#fog-of-war" title="Direct link to heading">#</a></h2><p>In this example, the <a href="/Edgar-Unity-DocsArchive/docs/guides/fog-of-war">Fog of War</a> feature is enabled. For more information on how to setup the feature, please see the <a href="/Edgar-Unity-DocsArchive/docs/guides/fog-of-war">documentation</a>. In order to integrate the Fog of War into this example scene, I modified the current room detection script (<code>GungeonCurrentRoomHandler</code> class) to trigger the fog when a player enters a corridor room, and I also modified the <code>GungeonPostProcessTask</code> class to setup the fog after a level is generated.</p><blockquote><p><strong>Note:</strong> The integration of the Fog of War effect into this example could be improved. I think that it looks better when the next room is revealed only after the player walks though the middle of a corridor and not right when he enters the corridor. Also, the integration with doors is not ideal - you can reveal rooms behind locked rooms if you go close to the door. I want to improve this in the future.</p></blockquote><blockquote><p><strong>Note:</strong> To disable the Fog of War effect, go to the main camera and disable the Fog of War component.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="results"></a>Results<a class="hash-link" href="#results" title="Direct link to heading">#</a></h2><div style="font-size:0px;margin:20px 0"><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result3.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result3.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Example result</div></div><div style="display:inline-block;margin:2px;overflow:hidden;position:relative;width:calc(50% - 4px);vertical-align:top"><a href="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result4.png" target="_blank"><img src="/Edgar-Unity-DocsArchive/img/v2/examples/gungeon/result4.png" alt="result" style="height:400px;object-fit:cover"></a><div style="font-size:16px;font-style:italic;text-align:center;margin:10px 0px 15px">Example result</div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/OndrejNepozitek/Edgar-Unity/tree/docusaurus/versioned_docs/version-2.0.0-alpha.9/examples/enter-the-gungeon.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Edgar-Unity-DocsArchive/docs/examples/isometric-1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« (PRO) Isometric 1</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Edgar-Unity-DocsArchive/docs/examples/dead-cells"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">(PRO) Dead Cells Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#room-templates" class="table-of-contents__link">Room templates</a></li><li><a href="#level-graphs" class="table-of-contents__link">Level graphs</a><ul><li><a href="#custom-rooms-and-connections" class="table-of-contents__link">Custom rooms and connections</a></li><li><a href="#input-setup-task" class="table-of-contents__link">Input setup task</a></li><li><a href="#pick-random-level-graph" class="table-of-contents__link">Pick random level graph</a></li><li><a href="#random-secret-rooms" class="table-of-contents__link">Random secret rooms</a></li></ul></li><li><a href="#room-manager" class="table-of-contents__link">Room manager</a><ul><li><a href="#current-room-detection" class="table-of-contents__link">Current room detection</a></li><li><a href="#enemies" class="table-of-contents__link">Enemies</a></li><li><a href="#doors" class="table-of-contents__link">Doors</a></li><li><a href="#locked-doors" class="table-of-contents__link">Locked doors</a></li></ul></li><li><a href="#fog-of-war" class="table-of-contents__link">Fog of War</a></li><li><a href="#results" class="table-of-contents__link">Results</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Edgar-Unity-DocsArchive/docs/introduction">Introduction</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/OndrejNepozitek" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://ondra.nepozitek.cz/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/OndrejNepozitek/Edgar-Unity" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 OndÅ™ej NepoÅ¾itek</div></div></div></footer></div>
<script src="/Edgar-Unity-DocsArchive/styles.1de33962.js"></script>
<script src="/Edgar-Unity-DocsArchive/runtime~main.ed91e56c.js"></script>
<script src="/Edgar-Unity-DocsArchive/main.b98b1f40.js"></script>
<script src="/Edgar-Unity-DocsArchive/1.2b6eab23.js"></script>
<script src="/Edgar-Unity-DocsArchive/1be78505.36a57963.js"></script>
<script src="/Edgar-Unity-DocsArchive/300.10d19e34.js"></script>
<script src="/Edgar-Unity-DocsArchive/301.5c69e847.js"></script>
<script src="/Edgar-Unity-DocsArchive/0e62f188.31cbd126.js"></script>
<script src="/Edgar-Unity-DocsArchive/299.f7900408.js"></script>
<script src="/Edgar-Unity-DocsArchive/cbd1a036.12b7f0af.js"></script>
</body>
</html>