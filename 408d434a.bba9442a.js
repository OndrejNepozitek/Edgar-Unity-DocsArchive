(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{127:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return l})),r.d(t,"metadata",(function(){return c})),r.d(t,"toc",(function(){return s})),r.d(t,"default",(function(){return u}));var n=r(3),a=r(7),o=(r(0),r(371)),i=r(374),l={title:"Procedural level graphs"},c={unversionedId:"guides/procedural-level-graphs",id:"version-1.0.3/guides/procedural-level-graphs",isDocsHomePage:!1,title:"Procedural level graphs",description:"The goal of this tutorial is to show you one possible approach to generating procedural level graphs. I will not try to show how to generate interesting level graphs but rather describe what needs to be done in general.",source:"@site/versioned_docs\\version-1.0.3\\guides\\procedural-level-graphs.md",slug:"/guides/procedural-level-graphs",permalink:"/Edgar-Unity-DocsArchive/docs/1.0.3/guides/procedural-level-graphs",editUrl:"https://github.com/OndrejNepozitek/Edgar-Unity/tree/docusaurus/versioned_docs/version-1.0.3/guides/procedural-level-graphs.md",version:"1.0.3",sidebar:"version-1.0.3/docs",previous:{title:"Adding door tiles",permalink:"/Edgar-Unity-DocsArchive/docs/1.0.3/guides/adding-door-tiles"},next:{title:"Corridors correction",permalink:"/Edgar-Unity-DocsArchive/docs/1.0.3/guides/corridors-correction"}},s=[{value:"Goal",id:"goal",children:[]},{value:"Implementation",id:"implementation",children:[]},{value:"Performance",id:"performance",children:[]},{value:"Results",id:"results",children:[]}],p={toc:s};function u(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},p,r,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"The goal of this tutorial is to show you one possible approach to generating procedural level graphs. I will not try to show how to generate interesting level graphs but rather describe what needs to be done in general."),Object(o.b)("h2",{id:"goal"},"Goal"),Object(o.b)("h4",{id:"main-path"},"Main path"),Object(o.b)("p",null,"We will start with a simple path from the spawn room to the boss room. This path is called the ",Object(o.b)("em",{parentName:"p"},"main path")," in the source code. We will choose the number of rooms on the main path randomly from a predefined range."),Object(o.b)("h4",{id:"shortcut"},"Shortcut"),Object(o.b)("p",null,"We will add a shortcut from a randomly chosen room on the main path to another randomly chosen room. In other words, there will be one cycle in the level graph."),Object(o.b)("h4",{id:"redundant-rooms"},"Redundant rooms"),Object(o.b)("p",null,"We will randomly choose rooms on the main path or on the shortcut and connect one or two new rooms that will not lead to the boss room but rather make the dungeon more non-linear."),Object(o.b)("h2",{id:"implementation"},"Implementation"),Object(o.b)("p",null,"The implementation together with documentation comments and an example scene can be found ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/OndrejNepozitek/ProceduralLevelGenerator-Unity/tree/master/Assets/ProceduralLevelGenerator/Examples/ProceduralLevelGraphs"}),"here"),"."),Object(o.b)("h4",{id:"room-and-roomtype-classes"},Object(o.b)("inlineCode",{parentName:"h4"},"Room")," and ",Object(o.b)("inlineCode",{parentName:"h4"},"RoomType")," classes"),Object(o.b)("p",null,"The default input task (",Object(o.b)("inlineCode",{parentName:"p"},"FixedInputTask"),") works with a room class that is used in GUI and is not very suitable for our usecase. Therefore I prepared a custom class that will hold information about our rooms and also an enum that codes several types of rooms. The two types are currently very simple but can be extended to carry more information."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-csharp"}),"/// <summary>\n/// Custom room type.\n/// </summary>\npublic class Room\n{\n    public RoomType Type { get; set; }\n}\n")),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-csharp"}),"/// <summary>\n/// Type of room.\n/// </summary>\npublic enum RoomType\n{\n    Basic, Spawn, Boss, Redundant, Shortcut\n}\n")),Object(o.b)("h4",{id:"custom-payload-initializer"},"Custom payload initializer"),Object(o.b)("p",null,"Because we have a custom room type, we need a payload initializer that returns a payload that works with our room type. Its implementation is very simple. We inherit from the base payload initializer and return a payload specialized for our room type."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-csharp"}),'[CreateAssetMenu(menuName = "Dungeon generator/Examples/Procedural level graphs/Payload initializer", fileName = "PayloadInitializer")]\npublic class CustomPayloadInitializer : PayloadInitializer\n{\n    public override object InitializePayload()\n    {\n        return InitializePayload<Room>();\n    }\n}\n')),Object(o.b)("p",null,"We must not forget to use this payload initializer when we setup the generator pipeline script."),Object(o.b)("h4",{id:"task-config"},"Task config"),Object(o.b)(i.c,{src:"img/original/procedural_level_graph_inspector.png",mdxType:"Image"}),Object(o.b)("h2",{id:"performance"},"Performance"),Object(o.b)("p",null,"The algorithm is sometimes unable to generate a dungeon under 10 seconds, which is the default timeout period. In this particular example, it is probably because:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"We have too few room templates"),Object(o.b)("li",{parentName:"ul"},"We accidentally made the level graph too complex"),Object(o.b)("li",{parentName:"ul"},"The underlying algorithm needs performance improvements")),Object(o.b)("h2",{id:"results"},"Results"),Object(o.b)(i.a,{cols:2,fixedHeight:!0,mdxType:"Gallery"},Object(o.b)(i.b,{src:"img/original/procedural_level_graph_example1.png",caption:"Only main path",mdxType:"GalleryImage"}),Object(o.b)(i.b,{src:"img/original/procedural_level_graph_example2.png",caption:"Only main path",mdxType:"GalleryImage"}),Object(o.b)(i.b,{src:"img/original/procedural_level_graph_example3.png",caption:"With a shortcut",mdxType:"GalleryImage"}),Object(o.b)(i.b,{src:"img/original/procedural_level_graph_example4.png",caption:"With a shortcut",mdxType:"GalleryImage"}),Object(o.b)(i.b,{src:"img/original/procedural_level_graph_example5.png",caption:"With redundant rooms",mdxType:"GalleryImage"}),Object(o.b)(i.b,{src:"img/original/procedural_level_graph_example6.png",caption:"With redundant rooms",mdxType:"GalleryImage"})))}u.isMDXComponent=!0},371:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return b}));var n=r(0),a=r.n(n);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=a.a.createContext({}),p=function(e){var t=a.a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},u=function(e){var t=p(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),u=p(r),m=n,b=u["".concat(i,".").concat(m)]||u[m]||d[m]||o;return r?a.a.createElement(b,l(l({ref:t},s),{},{components:r})):a.a.createElement(b,l({ref:t},s))}));function b(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},372:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(22),a=r(373);function o(){const{siteConfig:{baseUrl:e="/",url:t}={}}=Object(n.default)();return{withBaseUrl:(r,n)=>function(e,t,r,{forcePrependBaseUrl:n=!1,absolute:o=!1}={}){if(!r)return r;if(r.startsWith("#"))return r;if(Object(a.b)(r))return r;if(n)return t+r;const i=r.startsWith(t)?r:t+r.replace(/^\//,"");return o?e+i:i}(t,e,r,n)}}function i(e,t={}){const{withBaseUrl:r}=o();return r(e,t)}},373:function(e,t,r){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!n(e)}r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}))},374:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u}));var n=r(3),a=r(0),o=r.n(a),i=r(372);const l=e=>o.a.createElement("div",{style:{display:"inline-block",margin:2,overflow:"hidden",position:"relative",width:`calc(${100/e.cols}% - 4px)`,verticalAlign:"top"}},e.children),c=e=>o.a.createElement("div",{style:{fontSize:"0px",margin:"20px 0"}},o.a.Children.map(e.children,(t=>o.a.cloneElement(t,{cols:e.cols||4,fixedHeight:e.fixedHeight})))),s=e=>o.a.createElement(l,{cols:e.cols},o.a.createElement("a",{href:Object(i.a)(e.src),target:"_blank"},o.a.createElement("img",{src:Object(i.a)(e.src),alt:"result",style:{height:!0===e.fixedHeight?800/e.cols+"px":"auto",objectFit:!0===e.fixedHeight?"cover":"initial"}})),void 0!==e.caption&&o.a.createElement(p,null,e.caption)),p=e=>o.a.createElement("div",{style:{fontSize:16,fontStyle:"italic",textAlign:"center",margin:"10px 0px 15px"}},e.children),u=e=>{const{src:t,caption:r,...a}=e;return o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("img",Object(n.a)({src:Object(i.a)(e.src)},a)),void 0!==e.caption&&o.a.createElement(p,null,e.caption))}}}]);